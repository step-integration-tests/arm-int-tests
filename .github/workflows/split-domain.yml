name: Split Domain

on:
  workflow_dispatch:
    inputs:
      WorkflowFileID:
        description: "WorkflowID"
        required: false
        default: ""
      NumThreads:
        description: "Number of parallel threads (default: 4)"
        required: false
        default: "4"

jobs:
  test-domains-parallel:
    runs-on: ubuntu-latest
    steps:
      - uses: step-security/harden-runner@v2
        with:
          egress-policy: block
          allowed-endpoints: >
            api.github.com:443
            github.com:443
            codeload.github.com:443
            objects.githubusercontent.com:443
            *.actions.githubusercontent.com:443
            release-assets.githubusercontent.com:443
            pypi.org:443
            files.pythonhosted.org:443
            google.com:443
            youtube.com:443
            facebook.com:443
            baidu.com:443
            yahoo.com:443
            amazon.com:443
            wikipedia.org:443
            google.co.in:443
            twitter.com:443
            qq.com:443
            live.com:443
            taobao.com:443
            bing.com:443
            google.co.jp:443
            msn.com:443
            yahoo.co.jp:443
            linkedin.com:443
            sina.com.cn:443
            instagram.com:443
            weibo.com:443
            vk.com:443
            yandex.ru:443
            google.de:443
            google.ru:443
            hao123.com:443
            ebay.com:443
            reddit.com:443
            google.co.uk:443
            google.com.br:443
            mail.ru:443
            t.co:443
            pinterest.com:443
            amazon.co.jp:443
            google.fr:443
            netflix.com:443
            gmw.cn:443
            tmall.com:443
            360.cn:443
            google.it:443
            microsoft.com:443
            onclickads.net:443
            google.es:443
            paypal.com:443
            sohu.com:443
            wordpress.com:443
            tumblr.com:443
            blogspot.com:443
            imgur.com:443
            xvideos.com:443
            google.com.mx:443
            naver.com:443
            stackoverflow.com:443
            apple.com:443
            chinadaily.com.cn:443
            fc2.com:443
            aliexpress.com:443
            imdb.com:443
            google.ca:443
            google.co.kr:443
            github.com:443
            ok.ru:443
            pornhub.com:443
            google.com.hk:443
            whatsapp.com:443
            diply.com:443
            jd.com:443
            amazon.de:443
            google.com.tr:443
            rakuten.co.jp:443
            craigslist.org:443
            office.com:443
            google.co.id:443
            amazon.in:443
            wiley.com:443
            blogger.com:443
            google.pl:443
            nicovideo.jp:443
            alibaba.com:443
            soso.com:443
            pixnet.net:443
            google.com.au:443
            go.com:443
            amazon.co.uk:443
            xhamster.com:443
            dropbox.com:443
            google.com.tw:443
            outbrain.com:443
            xinhuanet.com:443
            cntv.cn:443
            googleusercontent.com:443
            cnn.com:443
            ask.com:443
            coccoc.com:443
            booking.com:443
            bbc.co.uk:443
            popads.net:443
            youth.cn:443
            twitch.tv:443
            wikia.com:443
            legacy.com:443
            quora.com:443
            chase.com:443
            adobe.com:443
            163.com:443
            360.com:443
            haosou.com:443
            google.com.pk:443
            google.co.th:443
            google.com.eg:443
            google.com.ar:443
            youku.com:443
            google.com.sa:443
            bbc.com:443
            flipkart.com:443
            alipay.com:443
            bongacams.com:443
            adf.ly:443
            nytimes.com:443
            google.nl:443
            sogou.com:443
            livedoor.jp:443
            daum.net:443
            txxx.com:443
            amazon.cn:443
            espn.go.com:443
            ebay.co.uk:443
            ettoday.net:443
            bankofamerica.com:443
            mynet.com:443
            indiatimes.com:443
            myway.com:443
            bilibili.com:443
            walmart.com:443
            ebay.de:443
            niuche.com:443
            godaddy.com:443
            dailymail.co.uk:443
            buzzfeed.com:443
            zillow.com:443
            xnxx.com:443
            salesforce.com:443
            dailymotion.com:443
            wellsfargo.com:443
            detail.tmall.com:443
            steampowered.com:443
            steamcommunity.com:443
            nametests.com:443
            google.co.ve:443
            theguardian.com:443
            google.com.ua:443
            indeed.com:443
            ameblo.jp:443
            aol.com:443
            etsy.com:443
            globo.com:443
            google.co.za:443
            yelp.com:443
            genius.com:443
            huffingtonpost.com:443
            tudou.com:443
            so.com:443
            zhihu.com:443
            soundcloud.com:443
            tripadvisor.com:443
            google.gr:443
            duowan.com:443
            avito.ru:443
            onlinesbi.com:443
            vice.com:443
            cnzz.com:443
            fandango.com:443
            uol.com.br:443
            bet365.com:443
            weather.com:443
            mediafire.com:443
            uptodown.com:443
            cnet.com:443
            washingtonpost.com:443
            gawker.com:443
            goo.ne.jp:443
            stackexchange.com:443
            force.com:443
            taboola.com:443
            google.com.co:443
            dmm.co.jp:443
            tuberel.com:443
            vimeo.com:443
            google.com.ng:443
            commentcamarche.net:443
            feedly.com:443
            theladbible.com:443
            pixiv.net:443
            redtube.com:443
            detik.com:443
            homedepot.com:443
            torrentz.eu:443
            slideshare.net:443
            google.ro:443
            taringa.net:443
            foxnews.com:443
            target.com:443
            amazon.it:443
            google.com.pe:443
            flickr.com:443
            hclips.com:443
            google.be:443
            amazon.fr:443
            9gag.com:443
            kakaku.com:443
            blogspot.in:443
            ikea.com:443
            mega.nz:443
            ifeng.com:443
            udn.com:443
            web.de:443
            americanexpress.com:443
            iqiyi.com:443
            milanuncios.com:443
            fbcdn.net:443
            google.com.ph:443
            orange.fr:443
            g2a.com:443
            google.com.sg:443
            terraclicks.com:443
            youm7.com:443
            putlocker.is:443
            tribunnews.com:443
            gmx.net:443
            youporn.com:443
            deviantart.com:443
            nih.gov:443
            zol.com.cn:443
            6pm.com:443
            roblox.com:443
            doubleclick.net:443
            hdfcbank.com:443
            ozock.com:443
            tistory.com:443
            capitalone.com:443
            leboncoin.fr:443
            douyu.com:443
            google.cn:443
            51.la:443
            google.se:443
            spotify.com:443
            wikihow.com:443
            onet.pl:443
            babytree.com:443
            w3schools.com:443
            upornia.com:443
            snapdeal.com:443
            forbes.com:443
            google.at:443
            wix.com:443
            bestbuy.com:443
            livejournal.com:443
            mozilla.org:443
            indiamart.com:443
            xfinity.com:443
            handycafe.com:443
            groupon.com:443
            adnetworkperformance.com:443
            onedio.com:443
            thepiratebay.org:443
            skype.com:443
            github.io:443
            allegro.pl:443
            google.dz:443
            google.com.vn:443
            paytm.com:443
            qvc.com:443
            wikimedia.org:443
            icicibank.com:443
            t-online.de:443
            popcash.net:443
            telegraph.co.uk:443
            usps.com:443
            slither.io:443
            wp.pl:443
            blog.jp:443
            google.ch:443
            webtretho.com:443
            politico.com:443
            trello.com:443
            google.pt:443
            yesky.com:443
            babycenter.com:443
            huanqiu.com:443
            eksisozluk.com:443
            blastingnews.com:443
            citi.com:443
            shutterstock.com:443
            rediff.com:443
            files.wordpress.com:443
            1688.com:443
            google.cl:443
            bitauto.com:443
            speedtest.net:443
            pandora.com:443
            adexc.net:443
            imzog.com:443
            google.ae:443
            2ch.net:443
            google.cz:443
            whitepages.com:443
            seznam.cz:443
            ltn.com.tw:443
            about.com:443
            chaturbate.com:443
            ebay-kleinanzeigen.de:443
            slack.com:443
            mercadolivre.com.br:443
            google.co.il:443
            doorblog.jp:443
            goodreads.com:443
            livejasmin.com:443
            battle.net:443
            softonic.com:443
            accuweather.com:443
            amazon.es:443
            wordpress.org:443
            mbc.net:443
            slickdeals.net:443
            icloud.com:443
            uptobox.com:443
            google.hu:443
            kaskus.co.id:443
            pixabay.com:443
            fedex.com:443
            ndtv.com:443
            att.com:443
            mlb.com:443
            kompas.com:443
            google.ie:443
            giphy.com:443
            usatoday.com:443
            bedbathandbeyond.com:443
            hulu.com:443
            archive.org:443
            sberbank.ru:443
            media.tumblr.com:443
            pinimg.com:443
            messenger.com:443
            sourceforge.net:443
            oracle.com:443
            hp.com:443
            lowes.com:443
            zendesk.com:443
            viralthread.com:443
            csdn.net:443
            1905.com:443
            internethaber.com:443
            360doc.com:443
            39.net:443
            digikala.com:443
            badoo.com:443
            businessinsider.com:443
            kinogo.co:443
            weebly.com:443
            samsung.com:443
            abs-cbn.:443
            hepsiburada.com:443
            airbnb.com:443
            sabah.com.tr:443
            wordreference.com:443
            hurriyet.com.:443
            uefa.com:443
            rambler.ru:443
            51yes.com:443
            cnnic.cn:443
            webmd.com:443
            ign.com:443
            liputan6.com:443
            dell.com:443
            gizmodo.com:443
            blogspot.com.br:443
            bloomberg.com:443
            blkget.com:443
            gsmarena.com:443
            evernote.com:443
            verizonwireless.com:443
            secureserver.net:443
            repubblica.it:443
            milliyet.com.tr:443
            isanalyze.com:443
            sharepoint.com:443
            eastday.com:443
            mailchimp.com:443
            match.com:443
            wowhead.com:443
            medium.com:443
            google.az:443
            chosun.com:443
            dmm.com:443
            billdesk.com:443
            wsj.com:443
            naukri.com:443
            kinopoisk.ru:443
            friv.com:443
            expedia.com:443
            livedoor.biz:443
            macys.com:443
            avg.com:443
            tube8.com:443
            libero.it:443
            intuit.com:443
            google.no:443
            google.fi:443
            urdupoint.com:443
            eonline.com:443
            addthis.com:443
            sahibinden.com:443
            ancestry.com:443
            likes.com:443
            savefrom.net:443
            haber7.com:443
            answers.com:443
            google.sk:443
            kissanime.to:443
            marca.com:443
            k618.cn:443
            ebay.in:443
            telekom.com:443
            wetransfer.com:443
            adplxmd.com:443
            spiegel.de:443
            bild.de:443
            livedoor.com:443
            ouo.io:443
            nownews.com:443
            elpais.com:443
            thesaurus.com:443
            rt.com:443
            amazon.ca:443
            vox.com:443
            ck101.com:443
            independent.co.uk:443
            reuters.com:443
            google.dk:443
            suning.com:443
            daikynguyenvn.com:443
            scribd.com:443
            themeforest.net:443
            lifebuzz.com:443
            acfun.tv:443
            box.com:443
            newegg.com:443
            nbcnews.com:443
            rutracker.org:443
            freepik.com:443
            telegram.org:443
            kapanlagi.com:443
            goal.com:443
            blogfa.com:443
            southwest.com:443
            openload.co:443
            hm.com:443
            kickstarter.com:443
            banggood.com:443
            thesportbible.com:443
            engadget.com:443
            impress.co.jp:443
            kohls.com:443
            playstation.com:443
            clickadu.com:443
            shopify.com:443
            tabelog.com:443
            mashable.com:443
            upwork.com:443
            espncricinfo.com:443
            conservativetribune.com:443
            siteadvisor.com:443
            realtor.com:443
            asos.com:443
            quizlet.com:443
            hatena.ne.jp:443
            usaa.com:443
            xe.com:443
            olx.pl:443
            videomega.tv:443
            ameba.jp:443
            atlassian.net:443
            sh.st:443
            ebay.it:443
            ctrip.com:443
            costco.com:443
            albawabhnews.com:443
            hatenablog.com:443
            gismeteo.ru:443
            souq.com:443
            google.by:443
            gofundme.com:443
            yallakora.com:443
            abcnews.go.com:443
            baike.com:443
            moneycontrol.com:443
            lifehacker.com:443
            wunderground.com:443
            hotels.com:443
            zippyshare.com:443
            zoho.com:443
            discovercard.com:443
            fidelity.com:443
            cnblogs.com:443
            zomato.com:443
            jabong.com:443
            digitaltrends.com:443
            nikkei.com:443
            4shared.com:443
            hubspot.com:443
            hespress.com:443
            theverge.com:443
            exoclick.com:443
            bhaskar.com:443
            gamer.com.tw:443
            webex.com:443
            neobux.com:443
            elmogaz.com:443
            gap.com:443
            gamepedia.com:443
            gamersky.com:443
            okezone.com:443
            gamefaqs.com:443
            infusionsoft.com:443
            ebay.com.au:443
            clipconverter.cc:443
            umblr.com:443
            ibm.com:443
            ticketmaster.com:443
            mercadolibre.com.ar:443
            beeg.com:443
            behance.net:443
            surveymonkey.com:443
            rbc.ru:443
            mcafee.com:443
            ca.gov:443
            trulia.com:443
            zing.vn:443
            elmundo.es:443
            mi.com:443
            aparat.com:443
            free.fr:443
            airtel.in:443
            blackboard.com:443
            meetup.com:443
            trackingclick.net:443
            google.bg:443
            google.lk:443
            adidas.tmall.com:443
            nordstrom.com:443
            merdeka.com:443
            ultimate-guitar.com:443
            nike.com:443
            list.tmall.com:443
            seesaa.net:443
            blogspot.jp:443
            allrecipes.com:443
            google.kz:443
            huaban.com:443
            nifty.com:443
            fiverr.com:443
            donga.com:443
            mobile.de:443
            npr.org:443
            kooora.com:443
            wayfair.com:443
            coursera.org:443
            to8to.com:443
            tutorialspoint.com:443
            panda.tv:443
            lenta.ru:443
            weblio.jp:443
            xda-developers.com:443
            asahi.com:443
            google.com.kw:443
            thefreedictionary.com:443
            adp.com:443
            kayak.com:443
            intel.com:443
            kijiji.ca:443
            youdao.com:443
            korabia.com:443
            chaoshi.tmall.com:443
            thedailybeast.com:443
            drudgereport.com:443
            eventbrite.com:443
            hotstar.com:443
            tradeadexchange.com:443
            hdzog.com:443
            change.org:443
            hootsuite.com:443
            dictionary.com:443
            makemytrip.com:443
            brightonclick.com:443
            streamcloud.eu:443
            norton.com:443
            cctv.com:443
            watsons.tmall.com:443
            prothom-alo.com:443
            researchgate.net:443
            ebates.com:443
            hotmovs.com:443
            olx.in:443
            sakura.ne.jp:443
            bookmyshow.com:443
            subscene.com:443
            le.com:443
            emol.com:443
            justdial.com:443
            11st.co.kr:443
            cookpad.com:443
            retailmenot.com:443
            thewatchseries.to:443
            basecamp.com:443
            slimspots.com:443
            corriere.it:443
            gmarket.co.kr:443
            overstock.com:443
            asus.com:443
            y8.com:443
            dcinside.com:443
            momoshop.com.tw:443
            woot.com:443
            shopclues.com:443
            csgolounge.com:443
            disqus.com:443
            so-net.ne.jp:443
            wattpad.com:443
            gmanetwork.com:443
            cbsnews.com:443
            leagueoflegends.com:443
            uber.com:443
            ryanair.com:443
            patch.com:443
            4399.com:443
            adbooth.com:443
            sabq.org:443
            dropbooks.tv:443
            www.gov.uk:443
            udemy.com:443
            cnmo.com:443
            bleacherreport.com:443
            aa.com:443
            lapatilla.com:443
            instructables.com:443
            clien.net:443
            ew.com:443
            nba.com:443
            mirror.co.uk:443
            interia.pl:443
            marketwatch.com:443
            ensonhaber.com:443
            yadi.sk:443
            line.me:443
            mercadolibre.com.ve:443
            e-hentai.org:443
            uploaded.net:443
            verizon.com:443
            pnc.com:443
            namu.wiki:443
            yodobashi.com:443
            heroquizz.com:443
            latimes.com:443
            123cha.com:443
            pof.com:443
            eyny.com:443
            azlyrics.com:443
            aliyun.com:443
            people.com:443
            yandex.com.tr:443
            rottentomatoes.com:443
            104.com.tw:443
            houzz.com:443
            time.com:443
            cisco.com:443
            ppomppu.co.kr:443
            cbssports.com:443
            biglobe.ne.jp:443
            jrj.com.cn:443
            xunlei.com:443
            lenovo.com:443
            usbank.com:443
            vk.me:443
            zulily.com:443
            asana.com:443
            youboy.com:443
            zone-telechargement.com:443
            glassdoor.com:443
            seasonvar.ru:443
            nikkeibp.co.jp:443
            investing.com:443
            google.com.do:443
            united.com:443
            teepr.com:443
            indianexpress.com:443
            wikiwiki.jp:443
            pch.com:443
            jimdo.com:443
            oeeee.com:443
            gyazo.com:443
            myfitnesspal.com:443
            yts.ag:443
            breitbart.com:443
            123rf.com:443
            nextdoor.com:443
            voc.com.cn:443
            cnbc.com:443
            sears.com:443
            bs.to:443
            itmedia.co.jp:443
            thekitchn.com:443
            bomb01.com:443
            slate.com:443
            google.com.my:443
            4chan.org:443
            biobiochile.cl:443
            google.co.nz:443
            okcupid.com:443
            google.rs:443
            instructure.com:443
            intoday.in:443
            stumbleupon.com:443
            chinaso.com:443
            squarespace.com:443
            fitbit.com:443
            photobucket.com:443
            eskimi.com:443
            mixi.jp:443
            4dsply.com:443
            thatviralfeed.com:443
            pantip.com:443
            as.com:443
            elfagr.org:443
            3dmgame.com:443
            howtogeek.com:443
            aastocks.com:443
            manoramaonline.com:443
            chron.com:443
            inquirer.net:443
            t-mobile.com:443
            xbox.com:443
            meaww.com:443
            pogo.com:443
            redfin.com:443
            buy.tmall.com:443
            drom.ru:443
            infoseek.co.jp:443
            buzzfil.net:443
            urbandictionary.com:443
            mit.edu:443
            olx.com.br:443
            chinaz.com:443
            chip.de:443
            panet.co.il:443
            gamespot.com:443
            google.com.ec:443
            subito.it:443
            gazetaexpress.com:443
            zara.com:443
            swagbucks.com:443
            tmz.com:443
            nexusmods.com:443
            tsite.jp:443
            timeanddate.com:443
            discuss.com.hk:443
            quanjing.com:443
            bhphotovideo.com:443
            lequipe.fr:443
            superuser.com:443
            ero-advertising.com:443
            myntra.com:443
            cdiscount.com:443
            issuu.com:443
            filehippo.com:443
            vporn.com:443
            quikr.com:443
            126.com:443
            gameforge.com:443
            twoo.com:443
            microsoftstore.com:443
            java.com:443
            blogspot.mx:443
            spankbang.com:443
            discover.com:443
            bt.com:443
            agar.io:443
            priceline.com:443
            mercadolibre.com.mx:443
            atwiki.jp:443
            audible.com:443
            mynavi.jp:443
            vodlocker.com:443
            sky.com:443
            sciencedirect.com:443
            gigazine.net:443
            olx.ua:443
            abs-cbn.com:443
            hurriyet.com.tr:443
            android.com:443
    
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.x'

      - name: Extract and test domains in parallel
        run: |
          #!/bin/bash
          set +e  # Continue on errors

          echo "Extracting domains from workflow file..."

          # Extract domains from the original workflow
          domains=($(grep -oP 'run: curl.*https://\K[^"]+' .github/workflows/domains.yml | sort -u))

          total_domains=${#domains[@]}
          num_threads=${{ inputs.NumThreads }}
          domains_per_thread=$(( ($total_domains + $num_threads - 1) / $num_threads ))

          echo "=========================================="
          echo "Total domains found: $total_domains"
          echo "Number of threads: $num_threads"
          echo "Domains per thread: ~$domains_per_thread"
          echo "=========================================="

          # Function to test a domain
          test_domain() {
            domain=$1
            echo "Testing $domain..."
            curl --max-time 5 --connect-timeout 5 -Iv "https://$domain" 2>&1 || echo "Failed to connect to $domain"
            echo ""
          }

          export -f test_domain

          # Function to process a thread's domains
          process_thread() {
            thread_num=$1
            shift
            thread_domains=("$@")

            echo "Thread $thread_num: Starting to test ${#thread_domains[@]} domains..."

            for domain in "${thread_domains[@]}"; do
              test_domain "$domain"
            done

            echo "Thread $thread_num: Completed!"
          }

          export -f process_thread

          echo "Starting $num_threads parallel threads..."
          echo "=========================================="

          # Split domains and launch threads
          for ((i=0; i<$num_threads; i++)); do
            start_idx=$(( $i * $domains_per_thread ))
            end_idx=$(( ($i + 1) * $domains_per_thread ))

            # Get domains for this thread
            thread_domains=("${domains[@]:$start_idx:$domains_per_thread}")

            # Launch thread in background
            process_thread $(($i + 1)) "${thread_domains[@]}" &
          done

          # Wait for all threads to complete
          wait

          echo "=========================================="
          echo "All $num_threads threads completed!"
          echo "Total domains tested: $total_domains"
      
     
