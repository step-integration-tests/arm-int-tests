name: Test Fail with Compromised Action

on:
  workflow_dispatch:

permissions:
  contents: read

jobs:
  test-fail:
    runs-on: ubuntu-latest
    permissions:
      contents: read

    steps:
      - name: Harden Runner
        uses: step-security/harden-runner@f4a75cfd619ee5ce8d5b864b0d183aff3c69b55a # v2.13.1
        with:
          egress-policy: audit

      - name: sleep
        run: |
          echo "Sleep 5"
          sleep 5


      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Use compromised action (should be blocked)
        uses: step-security/dummy-compromised-action@c96c327cecdb71e8f031080ba8ad208feb25b13d # v1
        
      - name: sleep
        if: always()
        run: |
          echo "Sleep 5"
          sleep 5

      - name: Display results
        run: |
          echo "Workflow completed successfully"
          echo "This is a fail scenario for workflow run policies"
